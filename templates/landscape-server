# When DEPLOYED_FROM="charm", package upgrades will attempt to stop, start or
# restart any of the Landscape services.
DEPLOYED_FROM="charm"

# To run all Landscape services (including cron jobs) set this to "yes".
# Alternatively, set this to a number between 1 and 9 to have that number
# of services to start for each kind that supports this (currently, only
# msg, ping and app support multiple instances).
RUN_ALL="no"

# To run only specific Landscape services set RUN_ALL to "no" and then
# set the services you want to run to "yes".
# If you want to start more than one copy of each service, use a number
# instead of "yes" or "no". Currently, only msg, app and ping support this.
RUN_APPSERVER="yes"
RUN_ASYNC_FRONTEND="yes"
RUN_JOBHANDLER="yes"
RUN_MSGSERVER="{{ service_counts["message-server"] }}"
RUN_PINGSERVER="{{ service_counts["pingserver"] }}"
RUN_APISERVER="yes"
{% if is_leader and hosted[0]["deployment-mode"] == "standalone" %}
RUN_JUJU_SYNC="yes"
{% else %}
RUN_JUJU_SYNC="no"
{% endif %}

# To run cron jobs on this server when RUN_ALL="no" set RUN_CRON to "yes".
# Cron jobs should run only on a single unit (usually the leader).
{% if is_leader %}
RUN_CRON="yes"
{% else %}
RUN_CRON="no"
{% endif %}

# Package search should only be run on a single unit (the leader).
{% if is_leader %}
RUN_PACKAGESEARCH="yes"
{% else %}
RUN_PACKAGESEARCH="no"
{% endif %}

# Enable the package upload service on the leader.
# XXX: This means it is *not* HA: if the leader dies, the data is lost (for now)
{% if is_leader %}
RUN_PACKAGEUPLOADSERVER="yes"
{% else %}
RUN_PACKAGEUPLOADSERVER="no"
{% endif %}
